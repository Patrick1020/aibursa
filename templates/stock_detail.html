<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>{{ symbol }} â€“ Detalii PredicÈ›ie</title>
    <link rel="stylesheet" href="/static/styles.css">
    <style>
        body { background: #101624; color: #f0f2fa; }
        .container { max-width: 820px; margin: 40px auto; background: #171e2c; padding: 32px 40px; border-radius: 18px; box-shadow: 0 2px 18px #0007; }
        h2, h3 { color: #6cd4ff; }
        .pred-box { margin-bottom: 34px; padding: 18px; background: #192132; border-radius: 11px; box-shadow: 0 2px 10px #0004; }
        .label { color: #ffd02e; font-weight: 600; }
        .back-link { color: #6cd4ff; text-decoration: underline; cursor: pointer; margin-bottom: 18px; display: inline-block;}
        pre { background: #151a2c; border-radius: 8px; padding: 6px 8px; }
        table { width: 100%; margin-bottom: 28px; border-collapse: collapse; }
        td, th { padding: 8px 10px; }
        td:first-child { color: #ffe480; font-weight: 600; width: 160px; }
        td:last-child { color: #8ce5ff; }
        .section-box { background: #141a29; padding: 20px; border-radius: 12px; margin-bottom: 32px; }
        ul.news-list, ul.historic-list { padding-left: 22px; }
        .impact-up { color: #61ff8a; font-weight: 600; }
        .impact-down { color: #ff4a4a; font-weight: 600; }
    </style>
</head>
<body>
<div class="container">
    <a class="back-link" href="/dashboard">&larr; Back to Dashboard</a>
    <h2>Detalii pentru <span style="color:#fff">{{ symbol }}</span></h2>

    <!-- PredicÈ›ii AI -->
    <div class="section-box">
        <h3>ðŸ§  PredicÈ›ii AI recente</h3>
        {% for p in predictions %}
            <div class="pred-box">
                <div><span class="label">PredicÈ›ie:</span> {{ '%.2f' % p.estimated_change }}%</div>
                <div><span class="label">Data:</span> {{ p.published_at.strftime('%Y-%m-%d %H:%M') }}</div>
                <div><span class="label">ExplicaÈ›ie AI:</span>
                    <pre>{{ p.analysis }}</pre>
                </div>
                <div><span class="label">Titlu AI:</span> {{ p.title }}</div>
                <div><span class="label">Descriere:</span> {{ p.description }}</div>
                <div><span class="label">Probabilitate:</span> {{ p.probability|int }}% â€“ {{ p.prob_justification }}</div>
                <div><span class="label">Raport R/R:</span> {{ p.reward_to_risk }}</div>
                <div><span class="label">Recomandare:</span> {{ p.recommendation }} â€“ {{ p.reco_reason }}</div>
                <div><span class="label">Rezultat anticipat:</span> {{ p.trade_outcome }}</div>
                <div><span class="label">Justificare scurtÄƒ:</span> {{ p.short_justification }}</div>

            </div>
        {% endfor %}
    </div>

    <!-- È˜tiri recente -->
    <div class="section-box">
        <h3>ðŸ“° È˜tiri recente</h3>
        <ul class="news-list">
          {% for article in news %}
            <li style="margin-bottom:15px;">
              <a href="{{ article.url }}" target="_blank" style="color:#8ce5ff; font-weight:600;">
                {{ article.title }}
              </a><br>
              <small>{{ article.published_at[:10] if article.published_at else "" }}</small>
              <div style="color:#aaa; margin-top:2px;">{{ article.description }}</div>
            </li>
          {% else %}
            <li><i>No news found for this stock.</i></li>
          {% endfor %}
        </ul>
    </div>

    <!-- Date financiare fundamentale -->
    <div class="section-box">
        <h3>ðŸ“Š Date financiare fundamentale</h3>
        <table>
          {% for key, value in financials.items() %}
            <tr>
              <td>{{ key }}</td>
              <td>{{ value }}</td>
            </tr>
          {% else %}
            <tr><td colspan="2"><i>No financial data available.</i></td></tr>
          {% endfor %}
        </table>
    </div>

    <!-- Context istoric -->
    <div class="section-box">
        <h3>ðŸ“ˆ Context istoric (È™tiri similare)</h3>
        <ul class="historic-list">
          {% for h in historical_impacts %}
            <li style="margin-bottom:12px;">
              <b>{{ h.news_date.strftime('%Y-%m-%d') if h.news_date else '' }}</b>:
              {{ h.news }}<br>
              Impact:
              {% if h.impact %}
                <span class="{{ 'impact-up' if '+' in h.impact else 'impact-down' }}">{{ h.impact }}</span>
              {% else %}
                <span style="color:#ccc;">necunoscut</span>
              {% endif %}
            </li>
          {% else %}
            <li><i>No historical context found for this stock.</i></li>
          {% endfor %}
        </ul>
    </div>

</div>
</body>
</html>
